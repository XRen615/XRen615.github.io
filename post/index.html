<!DOCTYPE html>
<html>

<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-76515451-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-76515451-1');
  </script>
  

  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Posts  &middot; INCH2</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="http://xren615.github.io/post/">
  
  <link href="http://xren615.github.io/post/index.xml" rel="alternate" type="application/rss+xml" title="Posts" />
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css">
  <link rel="stylesheet" href="/css/styles.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
  <div class="navbar">
    <ul>
      <li><a href="/" class="logo-title">HELLO,WORLD!</a></li>
      <li><a href="/categories">CATEGORIES</a></li>
      <li><a href="/tags">TAGS</a></li>
    </ul>
  </div>
  <div class="container">
    <div class="title">
      <a href="/">
        <img src="/images/logo.png" width="260px" height="48px" />
      </a>
    </div>



  <a href="http://xren615.github.io/post/pctr/">
  <div class="post-title">
    <img src="/images/post-title-icon.png" />
    <div class="post-meta">
      <time>16 Jul 2018, 01:36</time>
      <h1>Tencent social ads algo. competition: wrap up</h1>
    </div>
  </div>
</a>
<div class="summary-content">
  腾讯2018社交广告大赛。与朋友一起，借助FB的&rsquo;Practical Lessons from Predicting Clicks on Ads at Facebook&rsquo;一文的基本架构进入决赛。主要流程总结如下
import numpy as np import pandas as pd import scipy from sklearn import preprocessing from sklearn.preprocessing import LabelEncoder from sklearn.preprocessing import OneHotEncoder from sklearn.feature_extraction.text import CountVectorizer from scipy import sparse from scipy.sparse import csr_matrix from sklearn.model_selection import train_test_split import lightgbm as lgb import time from sklearn.metrics import roc_auc_score print('Start loading Train, Test, Adfeature...') # Data Loading train = pd.read_csv(&quot;/home/riren/Documents/4fun/preliminary_contest_data/train.csv&quot;,sep=&quot;,&quot;) test = pd.
  
  <a href="/post/pctr/" class="summary-more">READ MORE</a>
  
</div>
  <hr class="summary-sep" />

  <a href="http://xren615.github.io/post/hadoop_streaming/">
  <div class="post-title">
    <img src="/images/post-title-icon.png" />
    <div class="post-meta">
      <time>08 Jul 2018, 20:58</time>
      <h1>Use Python on HDFS with Pig Latin UDF and Hadoop streaming</h1>
    </div>
  </div>
</a>
<div class="summary-content">
  在大多数情景中，当需要对HDFS上的数据做一些简单的ETL，我们常常直接选择Hive或者Apache Pig Latin来完成。而在其他少数情况下，如果想要插入其他脚本语言模块，如Python，来完成一些比较复杂的工作，这时我们一般有两种选择，UDF (User Defined Function) 或者Hadoop Streaming。
UDF with Python
It&rsquo;s simple to use Py UDF with pig, just put a .py file and a .pig file under the same directory.
E.g.
udf_testing.py
@outputSchema('word:chararray') def hi_world(): return &quot;hello world” def bingo(s): return s + 'bingo'  udf_testing.pig
REGISTER 'udf_testing.py' using jython as my_udfs; page_views = LOAD '/data/tracking/PageViewEvent/' USING LiAvroStorage('date.range', 'start.date=20171001;end.date=20171002;error.on.missing=false'); hello_users = FOREACH page_views GENERATE requestHeader.pageKey, my_udfs.hi_world(), my_udfs.bingo(requestHeader.pageKey);; DUMP hello_users;  Note: limitation from Jython
  
  <a href="/post/hadoop_streaming/" class="summary-more">READ MORE</a>
  
</div>
  <hr class="summary-sep" />

  <a href="http://xren615.github.io/post/toast/">
  <div class="post-title">
    <img src="/images/post-title-icon.png" />
    <div class="post-meta">
      <time>13 May 2018, 17:39</time>
      <h1>Toast :)</h1>
    </div>
  </div>
</a>
<div class="summary-content">
  I reserve my headline for @Leanne and propose a toast for her luck in next a few months
Praise the sun
  
</div>
  <hr class="summary-sep" />


<div class="paging">
  
  PAGE 1 / 4
  
  <a href="/post/page/2/" rel="next">
    <i class="fa fa-caret-right" aria-hidden="true"></i>
  </a>
  
</div>

<footer class="footer">
  COPYRIGHT (C) <a href="https://blog.lulab.net">DONGGEUN,BANG</a>. ALL RIGHTS RESERVED.
</footer>

</body>
</html>

